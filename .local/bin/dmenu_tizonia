#!/bin/bash

[[ "$(xdotool search --class st-tizonia)" != "" ]] && xdo activate -N st-tizonia && exit 0

# Have to manually define playlists until
# tizonia has a way to list playlists
tizc=~/.config/tizonia
spotify=$(cat "$tizc/spotify.txt")
gmusic=$(cat "$tizc/gmusic.txt")
plists=`(echo "${spotify[@]}" && echo "${gmusic[@]}") | sort -du`
options=$(echo "$plists" && echo "quit")
choice=$(echo "${options[@]}" | dmenu -i -p 'Playlist: ')

[[ "$choice" == "quit" || "$choice" == "" ||  "$(echo "${options[@]}" | grep "$choice")" == "" ]] && \
  echo "Program terminated." && exit 1

tizopt="--spotify-playlist"
[[ "$(echo "${spotify[@]}" | grep "$choice")" == "" ]] && \
[[ "$(echo "${gmusic[@]}" | grep "$choice")" != "" ]] && \
  tizopt="--gmusic-playlist"

st -c st-tizonia -t "tizonia - $choice" -e sh -c "tizonia $tizopt '$choice'"

